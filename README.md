================================================================================
ResNet-50 Training for ImageNet-10
================================================================================
Device: MPS (Metal Performance Shaders)
Device name: Apple Silicon

Loading data from: data
Training samples: 10400
Validation samples: 2600
Number of classes: 10

Creating ResNet-50 model from scratch...
Total parameters: 23,528,522
Optimizer: SGD (momentum=0.9, weight_decay=1e-4)
Scheduler: OneCycle (max_lr=0.01)

Starting training for 30 epochs...
================================================================================

Epoch 01 [Train]:   0%|                                                                                                                                                | 0/81 [00:00<?, ?it/s]/Users/narasimhateja/claude/era/imagenet/.venv/lib/python3.12/site-packages/torch/utils/data/dataloader.py:684: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, then device pinned memory won't be used.
  warnings.warn(warn_msg)
Epoch 01 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:21<00:00,  2.49s/it, loss=2.2492, acc=14.68%]
Epoch 01 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:36<00:00,  1.74s/it, loss=2.0433, acc=20.00%]

Epoch 1/30 | Time: 238.2s | LR: 0.000400
Train - Loss: 2.2492 | Acc: 14.68%
Val   - Loss: 2.0433 | Acc: 20.00%
>>> Saved best model: 20.00% <<<
================================================================================

Epoch 02 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [04:00<00:00,  2.96s/it, loss=2.1563, acc=19.21%]
Epoch 02 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:34<00:00,  1.64s/it, loss=2.1174, acc=21.54%]

Epoch 2/30 | Time: 274.5s | LR: 0.000690
Train - Loss: 2.1563 | Acc: 19.21%
Val   - Loss: 2.1174 | Acc: 21.54%
>>> Saved best model: 21.54% <<<
================================================================================

Epoch 03 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:45<00:00,  2.78s/it, loss=2.0532, acc=24.70%]
Epoch 03 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:38<00:00,  1.85s/it, loss=1.8456, acc=28.58%]

Epoch 3/30 | Time: 264.0s | LR: 0.001526
Train - Loss: 2.0532 | Acc: 24.70%
Val   - Loss: 1.8456 | Acc: 28.58%
>>> Saved best model: 28.58% <<<
================================================================================

Epoch 04 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:19<00:00,  2.47s/it, loss=1.9552, acc=29.08%]
Epoch 04 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:37<00:00,  1.81s/it, loss=1.6482, acc=38.69%]

Epoch 4/30 | Time: 237.8s | LR: 0.002806
Train - Loss: 1.9552 | Acc: 29.08%
Val   - Loss: 1.6482 | Acc: 38.69%
>>> Saved best model: 38.69% <<<
================================================================================

Epoch 05 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:54<00:00,  2.90s/it, loss=1.8307, acc=34.54%]
Epoch 05 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:33<00:00,  1.62s/it, loss=1.6235, acc=39.85%]

Epoch 5/30 | Time: 268.9s | LR: 0.004376
Train - Loss: 1.8307 | Acc: 34.54%
Val   - Loss: 1.6235 | Acc: 39.85%
>>> Saved best model: 39.85% <<<
================================================================================

Epoch 06 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:48<00:00,  2.83s/it, loss=1.7045, acc=38.30%]
Epoch 06 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:34<00:00,  1.63s/it, loss=1.4006, acc=47.73%]

Epoch 6/30 | Time: 263.1s | LR: 0.006045
Train - Loss: 1.7045 | Acc: 38.30%
Val   - Loss: 1.4006 | Acc: 47.73%
>>> Saved best model: 47.73% <<<
================================================================================

Epoch 07 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:18<00:00,  2.45s/it, loss=1.6247, acc=42.12%]
Epoch 07 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:44<00:00,  2.12s/it, loss=1.2688, acc=52.81%]

Epoch 7/30 | Time: 243.4s | LR: 0.007612
Train - Loss: 1.6247 | Acc: 42.12%
Val   - Loss: 1.2688 | Acc: 52.81%
>>> Saved best model: 52.81% <<<
================================================================================

Epoch 08 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:20<00:00,  2.48s/it, loss=1.5278, acc=46.20%]
Epoch 08 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:36<00:00,  1.73s/it, loss=1.2084, acc=54.12%]

Epoch 8/30 | Time: 236.9s | LR: 0.008887
Train - Loss: 1.5278 | Acc: 46.20%
Val   - Loss: 1.2084 | Acc: 54.12%
>>> Saved best model: 54.12% <<<
================================================================================

Epoch 09 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:31<00:00,  2.61s/it, loss=1.4656, acc=48.80%]
Epoch 09 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:34<00:00,  1.62s/it, loss=1.1199, acc=60.85%]

Epoch 9/30 | Time: 245.6s | LR: 0.009717
Train - Loss: 1.4656 | Acc: 48.80%
Val   - Loss: 1.1199 | Acc: 60.85%
>>> Saved best model: 60.85% <<<
================================================================================

Epoch 10 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:21<00:00,  2.48s/it, loss=1.4093, acc=51.61%]
Epoch 10 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:36<00:00,  1.74s/it, loss=1.1574, acc=59.77%]

Epoch 10/30 | Time: 237.7s | LR: 0.010000
Train - Loss: 1.4093 | Acc: 51.61%
Val   - Loss: 1.1574 | Acc: 59.77%
================================================================================

Epoch 11 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:31<00:00,  2.61s/it, loss=1.3530, acc=53.67%]
Epoch 11 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:39<00:00,  1.88s/it, loss=0.9700, acc=64.04%]

Epoch 11/30 | Time: 251.1s | LR: 0.009943
Train - Loss: 1.3530 | Acc: 53.67%
Val   - Loss: 0.9700 | Acc: 64.04%
>>> Saved best model: 64.04% <<<
================================================================================

Epoch 12 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:46<00:00,  2.80s/it, loss=1.2708, acc=56.48%]
Epoch 12 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:37<00:00,  1.78s/it, loss=1.2373, acc=60.77%]

Epoch 12/30 | Time: 264.0s | LR: 0.009775
Train - Loss: 1.2708 | Acc: 56.48%
Val   - Loss: 1.2373 | Acc: 60.77%
================================================================================

Epoch 13 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:31<00:00,  2.61s/it, loss=1.2157, acc=58.32%]
Epoch 13 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:39<00:00,  1.89s/it, loss=1.1839, acc=63.58%]

Epoch 13/30 | Time: 251.6s | LR: 0.009501
Train - Loss: 1.2157 | Acc: 58.32%
Val   - Loss: 1.1839 | Acc: 63.58%
================================================================================

Epoch 14 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:56<00:00,  2.91s/it, loss=1.1605, acc=60.74%]
Epoch 14 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:38<00:00,  1.81s/it, loss=0.8355, acc=71.35%]

Epoch 14/30 | Time: 274.2s | LR: 0.009126
Train - Loss: 1.1605 | Acc: 60.74%
Val   - Loss: 0.8355 | Acc: 71.35%
>>> Saved best model: 71.35% <<<
================================================================================

Epoch 15 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:27<00:00,  2.57s/it, loss=1.1532, acc=61.47%]
Epoch 15 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:45<00:00,  2.15s/it, loss=0.8406, acc=72.38%]

Epoch 15/30 | Time: 253.1s | LR: 0.008659
Train - Loss: 1.1532 | Acc: 61.47%
Val   - Loss: 0.8406 | Acc: 72.38%
>>> Saved best model: 72.38% <<<
================================================================================

Epoch 16 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:31<00:00,  2.61s/it, loss=1.1097, acc=62.82%]
Epoch 16 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:36<00:00,  1.73s/it, loss=0.7687, acc=74.92%]

Epoch 16/30 | Time: 247.9s | LR: 0.008110
Train - Loss: 1.1097 | Acc: 62.82%
Val   - Loss: 0.7687 | Acc: 74.92%
>>> Saved best model: 74.92% <<<
================================================================================

Epoch 17 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:36<00:00,  2.67s/it, loss=1.0736, acc=63.67%]
Epoch 17 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:34<00:00,  1.62s/it, loss=0.7833, acc=72.85%]

Epoch 17/30 | Time: 250.2s | LR: 0.007492
Train - Loss: 1.0736 | Acc: 63.67%
Val   - Loss: 0.7833 | Acc: 72.85%
================================================================================

Epoch 18 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:22<00:00,  2.50s/it, loss=1.0251, acc=65.83%]
Epoch 18 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:43<00:00,  2.08s/it, loss=0.7432, acc=75.46%]

Epoch 18/30 | Time: 246.2s | LR: 0.006818
Train - Loss: 1.0251 | Acc: 65.83%
Val   - Loss: 0.7432 | Acc: 75.46%
>>> Saved best model: 75.46% <<<
================================================================================

Epoch 19 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:36<00:00,  2.68s/it, loss=1.0030, acc=66.40%]
Epoch 19 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:34<00:00,  1.67s/it, loss=0.8283, acc=75.04%]

Epoch 19/30 | Time: 251.8s | LR: 0.006104
Train - Loss: 1.0030 | Acc: 66.40%
Val   - Loss: 0.8283 | Acc: 75.04%
================================================================================

Epoch 20 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:35<00:00,  2.66s/it, loss=0.9551, acc=68.52%]
Epoch 20 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:35<00:00,  1.71s/it, loss=0.6818, acc=77.08%]

Epoch 20/30 | Time: 251.5s | LR: 0.005364
Train - Loss: 0.9551 | Acc: 68.52%
Val   - Loss: 0.6818 | Acc: 77.08%
>>> Saved best model: 77.08% <<<
================================================================================

Epoch 21 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [04:20<00:00,  3.21s/it, loss=0.9266, acc=69.51%]
Epoch 21 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:41<00:00,  1.99s/it, loss=0.6096, acc=79.62%]

Epoch 21/30 | Time: 302.2s | LR: 0.004617
Train - Loss: 0.9266 | Acc: 69.51%
Val   - Loss: 0.6096 | Acc: 79.62%
>>> Saved best model: 79.62% <<<
================================================================================

Epoch 22 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:33<00:00,  2.63s/it, loss=0.8949, acc=70.08%]
Epoch 22 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:46<00:00,  2.24s/it, loss=0.5882, acc=80.35%]

Epoch 22/30 | Time: 260.3s | LR: 0.003878
Train - Loss: 0.8949 | Acc: 70.08%
Val   - Loss: 0.5882 | Acc: 80.35%
>>> Saved best model: 80.35% <<<
================================================================================

Epoch 23 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:29<00:00,  2.59s/it, loss=0.8463, acc=71.89%]
Epoch 23 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:35<00:00,  1.67s/it, loss=0.5205, acc=82.77%]

Epoch 23/30 | Time: 244.6s | LR: 0.003165
Train - Loss: 0.8463 | Acc: 71.89%
Val   - Loss: 0.5205 | Acc: 82.77%
>>> Saved best model: 82.77% <<<
================================================================================

Epoch 24 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:54<00:00,  2.89s/it, loss=0.8310, acc=72.27%]
Epoch 24 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:36<00:00,  1.75s/it, loss=0.5208, acc=83.38%]

Epoch 24/30 | Time: 271.2s | LR: 0.002492
Train - Loss: 0.8310 | Acc: 72.27%
Val   - Loss: 0.5208 | Acc: 83.38%
>>> Saved best model: 83.38% <<<
================================================================================

Epoch 25 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [04:30<00:00,  3.34s/it, loss=0.8058, acc=73.21%]
Epoch 25 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:35<00:00,  1.70s/it, loss=0.4863, acc=84.12%]

Epoch 25/30 | Time: 306.5s | LR: 0.001875
Train - Loss: 0.8058 | Acc: 73.21%
Val   - Loss: 0.4863 | Acc: 84.12%
>>> Saved best model: 84.12% <<<
================================================================================

Epoch 26 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:42<00:00,  2.75s/it, loss=0.7830, acc=74.05%]
Epoch 26 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:40<00:00,  1.92s/it, loss=0.4832, acc=84.19%]

Epoch 26/30 | Time: 263.0s | LR: 0.001329
Train - Loss: 0.7830 | Acc: 74.05%
Val   - Loss: 0.4832 | Acc: 84.19%
>>> Saved best model: 84.19% <<<
================================================================================

Epoch 27 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [04:00<00:00,  2.97s/it, loss=0.7581, acc=74.69%]
Epoch 27 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:39<00:00,  1.89s/it, loss=0.4386, acc=85.69%]

Epoch 27/30 | Time: 280.0s | LR: 0.000864
Train - Loss: 0.7581 | Acc: 74.69%
Val   - Loss: 0.4386 | Acc: 85.69%
>>> Saved best model: 85.69% <<<
================================================================================

Epoch 28 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:43<00:00,  2.76s/it, loss=0.7303, acc=75.72%]
Epoch 28 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:40<00:00,  1.95s/it, loss=0.4353, acc=86.08%]

Epoch 28/30 | Time: 264.3s | LR: 0.000491
Train - Loss: 0.7303 | Acc: 75.72%
Val   - Loss: 0.4353 | Acc: 86.08%
>>> Saved best model: 86.08% <<<
================================================================================

Epoch 29 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:37<00:00,  2.68s/it, loss=0.7340, acc=75.47%]
Epoch 29 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:35<00:00,  1.70s/it, loss=0.4198, acc=85.88%]

Epoch 29/30 | Time: 253.1s | LR: 0.000219
Train - Loss: 0.7340 | Acc: 75.47%
Val   - Loss: 0.4198 | Acc: 85.88%
================================================================================

Epoch 30 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 81/81 [03:51<00:00,  2.85s/it, loss=0.7233, acc=75.85%]
Epoch 30 [Val]  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21/21 [00:35<00:00,  1.70s/it, loss=0.4203, acc=85.69%]

Epoch 30/30 | Time: 266.8s | LR: 0.000055
Train - Loss: 0.7233 | Acc: 75.85%
Val   - Loss: 0.4203 | Acc: 85.69%
================================================================================


Training Complete!
Best validation accuracy: 86.08%
Models saved to: outputs/resnet50_20251014_210529
================================================================================